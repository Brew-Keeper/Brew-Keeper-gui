<nav class="recipe-list">
  <h3 ng-show="vm.isPublic">Public Recipes</h3>
  <h3 ng-show="username && !vm.isPublic">{{username}}'s Recipes</h3>
  <input class="magnify" placeholder="&#x1f50d" ng-model="searchString" name="search" ng-submit="vm.search(searchString)"/>
  <select name="OrderBy" value="OrderBy" ng-model="query">
    <option value="">Sort By</>
    <option value="-rating">Highest Rating</option>
    <option value="rating">Lowest Rating</option>
    <option value="-id">Newest</option>
    <option value="id">Oldest</option>
    <option ng-hide="vm.isPublic" value="-brew_count">Most Brewed</option>
    <option ng-hide="vm.isPublic" value="brew_count">Least Brewed</option>
  </select>
  <button name="search" class="clicker-button" ng-click="vm.search(searchString)">Search</button>
</nav>
<div class="coffee-spinner"><img src="img/coffee-spinner.gif" ng-hide="vm.recipes"/></div>
<section class="recipe-list" ng-repeat="recipe in vm.recipes | orderBy:vm.ratingOrderBy | orderBy:query | filter:filter">
  <a class="recipe-title" ng-show="vm.isPublic" href="#public/{{recipe.id}}">{{recipe.title}}</a>
  <a class="recipe-title" ng-show="!vm.isPublic" href="#{{username}}/{{recipe.id}}">{{recipe.title}}</a>
  <span>{{recipe.bean_name}}</span>
  <div class="col-1-2">
    <span>{{recipe.roast !== null ? recipe.roast + " Roast" : ''}}</span>
    <div class="col-1-4" ng-show="vm.isPublic"> <!-- public rating and shared by -->
      <!-- star rating -->
      <div class="col-1-3">
        <span ng-hide="username" ng-repeat="rating in vm.ratings">
          <div view-rating rating-value="recipe.average_rating" max="maxStars" ng-click="" class="public"></div>
        </span>
        <section ng-show="username">
          <span ng-hide="recipe.public_ratings.id" ng-repeat="rating in vm.ratings">
            <div star-rating rating-value="recipe.combined_rating" max="maxStars" ng-click="vm.newRating(recipe.combined_rating, recipe.id)" class="public"></div>
          </span>
          <span ng-show="recipe.public_ratings.id" ng-repeat="rating in vm.ratings">
            <div star-rating rating-value="recipe.public_ratings.public_rating" max="maxStars" ng-click="vm.updateRating(recipe.public_ratings.public_rating, recipe.public_ratings.id, recipe.id)"></div>
          </span>
        </section>
      </div>
    </div>
    <a class="shared-by" ng-show="recipe.shared_by" ng-href="#public/users/{{recipe.shared_by}}">Shared by <span>{{recipe.shared_by}}</span></a> <!-- end public rating and shared by -->
    <div class="col-1-4" ng-show="!vm.isPublic"> <!-- user rating -->
      <span class="rating" ng-repeat="rating in vm.ratings">
        <span star-rating rating-value="recipe.rating" max="maxStars" ng-click="vm.rateRecipe(recipe.rating, recipe.id)"></span>
      </span>  <!-- end star rating -->
      <span class="count"><img class="cup-icon" src="img/CoffeeCup-65.svg"/> &#215; {{recipe.brew_count}}</span>
    </div> <!-- end user rating -->
  </div> <!-- end col-1-2 -->
  <div class="col-1-2 button">
    <a class="list-brew-it" ng-show="recipe.steps.length" ng-click="vm.listBrewIt(recipe.id)">BREW IT!</a>
    <a class="list-brew-it" href="#{{username}}/{{recipe.id}}" ng-hide="recipe.steps.length">Add steps</a>
  </div> <!--end col-1-2 -->
</section><!-- end ng-repeat for recipe list -->
